{"version":3,"file":"favorites.js","sources":["../src/js/utils/fav_list.js"],"sourcesContent":["import renderItem, { ratingScale } from '../renders/renders';\r\nimport startPagination from './pagination';\r\nimport { OpenModal } from './modal-recipes';\r\nimport Notiflix from 'notiflix';\r\n\r\n// DOM elemanlarının tanımlanması - DOM elements declaration\r\nconst refs = {\r\n  favoriteCategoriesList: document.querySelector('.favorite-categories'),\r\n  favoriteRecipesList: document.querySelector('.favorite-list'),\r\n  warning: document.querySelector('.empty-storage'),\r\n  paginationBox: document.getElementById('pagination'),\r\n  allBtn: document.querySelector('.all-btn'),\r\n};\r\n\r\nlet currentCategory = '';\r\n\r\n// Çözünürlüğe göre sayfa sayısı - Page count by screen width\r\nconst calcPages = () => {\r\n  const screenWidth = window.innerWidth;\r\n  return screenWidth < 768 ? 9 : 12;\r\n};\r\n\r\nconst groupObjects = (array, groupSize) => {\r\n  const result = {};\r\n  for (let i = 0; i < array.length; i += groupSize) {\r\n    const groupName = Math.floor(i / groupSize) + 1;\r\n    result[groupName] = array.slice(i, i + groupSize);\r\n  }\r\n  return result;\r\n};\r\n\r\n// Favoriler sayfasının yenilenmesi - Favorites page reload\r\nconst onFavoritesReload = () => {\r\n  const categoryMarkup = generateCategoryList();\r\n  const allCatBtn = `<button class=\"button-fav all-btn\" name=\"all\">All categories</button>`;\r\n\r\n  const data = JSON.parse(localStorage.getItem('favorites')) || [];\r\n\r\n  refs.favoriteRecipesList.innerHTML = '';\r\n  refs.favoriteCategoriesList.innerHTML = '';\r\n\r\n  if (data.length) {\r\n    refs.favoriteCategoriesList.innerHTML = `${allCatBtn}${categoryMarkup}`;\r\n  } else {\r\n    refs.allBtn.style.display = 'none';\r\n  }\r\n\r\n  generateStorageList();\r\n};\r\n\r\n// Favoriler sayfasının oluşturulması - Favorites page creation\r\nconst generateStorageList = (pageSet = 1) => {\r\n  const storage = localStorage.getItem('favorites');\r\n  const data = JSON.parse(storage) || [];\r\n\r\n  refs.allBtn.style.display = 'none';\r\n\r\n  if (data.length) {\r\n    refs.allBtn.style.display = 'block';\r\n\r\n    const perPage = calcPages();\r\n    const objData = groupObjects(data, perPage);\r\n    const totalPages = Object.keys(objData).length;\r\n\r\n    if (totalPages > 1) {\r\n      refs.paginationBox.style.display = 'block';\r\n      startPagination(pageSet, perPage, totalPages, generateStorageList);\r\n    } else {\r\n      refs.paginationBox.style.display = 'none';\r\n    }\r\n\r\n    let filteredData;\r\n    if (currentCategory === '') {\r\n      filteredData = data;\r\n    } else {\r\n      filteredData = data.filter(recipe => recipe.category === currentCategory);\r\n    }\r\n\r\n    const listMarkup = filteredData.reduce(\r\n      (markup, { title, description, preview, rating, id, category }) =>\r\n        markup + renderItem(title, description, preview, rating, id, category),\r\n      ''\r\n    );\r\n\r\n    refs.favoriteRecipesList.innerHTML = listMarkup;\r\n\r\n    const favoriteButtons = document.querySelectorAll('.favorite-btn');\r\n    favoriteButtons.forEach(button => {\r\n      button.onclick = () => handleFavoriteButtonClick(button);\r\n    });\r\n\r\n    const seeRecipeButtons = document.querySelectorAll('.item-rec');\r\n    seeRecipeButtons.forEach(seeRecipeButton => {\r\n      seeRecipeButton.addEventListener('click', () => {\r\n        OpenModal(seeRecipeButton);\r\n      });\r\n    });\r\n\r\n    refs.warning.classList.add('is-hidden');\r\n  } else {\r\n    refs.warning.classList.remove('is-hidden');\r\n    refs.allBtn.classList.add('is-hidden');\r\n  }\r\n\r\n  if (data.length === 0) {\r\n    refs.warning.classList.remove('is-hidden');\r\n    refs.paginationBox.style.display = 'none';\r\n    refs.favoriteCategoriesList.innerHTML = '';\r\n    refs.allBtn.style.display = 'none';\r\n  } else {\r\n    refs.warning.classList.add('is-hidden');\r\n  }\r\n};\r\n\r\n// Kategorilerin oluşturulması - Categories creation\r\nconst generateCategoryList = () => {\r\n  const storage = localStorage.getItem('favorites');\r\n  const data = JSON.parse(storage) || [];\r\n  if (data.length) {\r\n    return data\r\n      .flatMap(recipe => recipe.category)\r\n      .filter((category, index, array) => array.indexOf(category) === index)\r\n      .reduce(\r\n        (categoryMarkup, category) => categoryMarkup + renderCategory(category),\r\n        ''\r\n      );\r\n  }\r\n  return '';\r\n};\r\n\r\nconst renderCategory = category =>\r\n  `<button class=\"button-fav\">${category}</button>`;\r\n\r\n// Kategoriye göre tarifleri filtreleme - Filter recipes by category\r\nconst filterByCategory = evt => {\r\n  if (evt.target.nodeName === 'BUTTON') {\r\n    if (evt.target.name === 'all') {\r\n      currentCategory = '';\r\n      setActiveClass(evt.target);\r\n    } else {\r\n      currentCategory = evt.target.textContent;\r\n      setActiveClass(evt.target);\r\n    }\r\n\r\n    generateStorageList();\r\n  }\r\n};\r\n\r\n// Aktif kategori butonunu ayarla - Set active category button\r\nconst setActiveClass = targetButton => {\r\n  const allCatBtn = document.querySelector('.all-btn');\r\n  const categoryButtons = document.querySelectorAll('.button-fav');\r\n\r\n  categoryButtons.forEach(button => {\r\n    if (button === targetButton) {\r\n      button.classList.add('onActive');\r\n    } else {\r\n      button.classList.remove('onActive');\r\n    }\r\n  });\r\n\r\n  allCatBtn.classList.remove('onActive');\r\n};\r\n\r\n// Favori tariflerden tarif silme - Remove recipe from favorites\r\nconst handleFavoriteButtonClick = button => {\r\n  const infoRecipe = JSON.parse(button.dataset.info);\r\n  const storage = localStorage.getItem('favorites');\r\n  let data = JSON.parse(storage) || [];\r\n\r\n  const recipeIndex = data.findIndex(recipe => recipe.id === infoRecipe.id);\r\n\r\n  if (recipeIndex !== -1) {\r\n    const removedRecipeCategory = data[recipeIndex].category;\r\n    data.splice(recipeIndex, 1);\r\n    localStorage.setItem('favorites', JSON.stringify(data));\r\n\r\n    const remainingData = JSON.parse(localStorage.getItem('favorites')) || [];\r\n    const otherRecipesInCategory = remainingData.some(\r\n      recipe => recipe.category === removedRecipeCategory\r\n    );\r\n\r\n    if (!otherRecipesInCategory) {\r\n      const recipeCards = document.querySelectorAll('.item');\r\n      recipeCards.forEach(card => {\r\n        if (card.dataset.category === removedRecipeCategory) {\r\n          card.remove();\r\n        }\r\n      });\r\n\r\n      const categoryButtons =\r\n        refs.favoriteCategoriesList.querySelectorAll('.button-fav');\r\n      categoryButtons.forEach(categoryButton => {\r\n        if (categoryButton.textContent === removedRecipeCategory) {\r\n          categoryButton.remove();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  // Favoriler sayfasının yenilenmesi - Favorites page reload\r\n  const remainingData = JSON.parse(localStorage.getItem('favorites')) || [];\r\n  if (remainingData.length === 0) {\r\n    refs.favoriteRecipesList.innerHTML = '';\r\n    refs.allBtn.style.display = 'none';\r\n    refs.warning.classList.remove('is-hidden');\r\n    refs.paginationBox.style.display = 'none';\r\n    refs.favoriteCategoriesList.innerHTML = '';\r\n  } else {\r\n    generateStorageList();\r\n  }\r\n};\r\n\r\ndocument.addEventListener('DOMContentLoaded', onFavoritesReload);\r\nrefs.favoriteCategoriesList.addEventListener('click', filterByCategory);\r\n"],"names":["refs","currentCategory","calcPages","groupObjects","array","groupSize","result","i","groupName","onFavoritesReload","categoryMarkup","generateCategoryList","allCatBtn","data","generateStorageList","pageSet","storage","perPage","objData","totalPages","startPagination","filteredData","recipe","listMarkup","markup","title","description","preview","rating","id","category","renderItem","button","handleFavoriteButtonClick","seeRecipeButton","OpenModal","index","renderCategory","filterByCategory","evt","setActiveClass","targetButton","infoRecipe","recipeIndex","removedRecipeCategory","card","categoryButton"],"mappings":"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"}